<!DOCTYPE html>

<html>
    <head>
        <title>MiladyCola</title>
        <link rel="shortcut icon" href="public/cola.gif" width=32px>
        <link 
            rel="stylesheet"
            href="style.css"
            >
            <script src="https://unpkg.com/web3@1.8.2/dist/web3.min.js"></script>

            <!-- bottle nft contract -->
            <script>

                const web3 = new Web3(Web3.givenProvider); 
                var accounts = [];
                var friend;
                var totalSup;
                var test = true;
                var saleOn = false;

                                    // The address of the smart contract that will mint the NFT
                const contractAddress = "0xE0c839D60F15dD0B939e93d9eeaB5ecDA9AffE57";
                

                // The ABI of the smart contract
                const contractABI = 
                [{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"name":"ApprovalCallerNotOwnerNorApproved","type":"error"},{"inputs":[],"name":"ApprovalQueryForNonexistentToken","type":"error"},{"inputs":[],"name":"BalanceQueryForZeroAddress","type":"error"},{"inputs":[],"name":"InvalidQueryRange","type":"error"},{"inputs":[],"name":"MintERC2309QuantityExceedsLimit","type":"error"},{"inputs":[],"name":"MintToZeroAddress","type":"error"},{"inputs":[],"name":"MintZeroQuantity","type":"error"},{"inputs":[],"name":"NewOwnerIsZeroAddress","type":"error"},{"inputs":[],"name":"NoHandoverRequest","type":"error"},{"inputs":[],"name":"OwnerQueryForNonexistentToken","type":"error"},{"inputs":[],"name":"OwnershipNotInitializedForExtraData","type":"error"},{"inputs":[],"name":"TransferCallerNotOwnerNorApproved","type":"error"},{"inputs":[],"name":"TransferFromIncorrectOwner","type":"error"},{"inputs":[],"name":"TransferToNonERC721ReceiverImplementer","type":"error"},{"inputs":[],"name":"TransferToZeroAddress","type":"error"},{"inputs":[],"name":"URIQueryForNonexistentToken","type":"error"},{"inputs":[],"name":"Unauthorized","type":"error"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"approved","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"operator","type":"address"},{"indexed":false,"internalType":"bool","name":"approved","type":"bool"}],"name":"ApprovalForAll","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"fromTokenId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"toTokenId","type":"uint256"},{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"}],"name":"ConsecutiveTransfer","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"pendingOwner","type":"address"}],"name":"OwnershipHandoverCanceled","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"pendingOwner","type":"address"}],"name":"OwnershipHandoverRequested","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"oldOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"Transfer","type":"event"},{"inputs":[],"name":"IPFSURI","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"approve","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"bottlePrice","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"bulkPrice","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"burn","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"cancelOwnershipHandover","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"uint256","name":"bottle","type":"uint256"},{"internalType":"uint256","name":"friend","type":"uint256"},{"internalType":"uint256","name":"bulk","type":"uint256"}],"name":"changePrice","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"pendingOwner","type":"address"}],"name":"completeOwnershipHandover","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"explicitOwnershipOf","outputs":[{"components":[{"internalType":"address","name":"addr","type":"address"},{"internalType":"uint64","name":"startTimestamp","type":"uint64"},{"internalType":"bool","name":"burned","type":"bool"},{"internalType":"uint24","name":"extraData","type":"uint24"}],"internalType":"struct IERC721A.TokenOwnership","name":"","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256[]","name":"tokenIds","type":"uint256[]"}],"name":"explicitOwnershipsOf","outputs":[{"components":[{"internalType":"address","name":"addr","type":"address"},{"internalType":"uint64","name":"startTimestamp","type":"uint64"},{"internalType":"bool","name":"burned","type":"bool"},{"internalType":"uint24","name":"extraData","type":"uint24"}],"internalType":"struct IERC721A.TokenOwnership[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"flipSaleState","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"holder","type":"address"}],"name":"friendCheck","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"friendPrice","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"getApproved","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"operator","type":"address"}],"name":"isApprovedForAll","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"numberOfTokens","type":"uint256"}],"name":"mintFriend","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"uint256","name":"numberOfTokens","type":"uint256"}],"name":"mintNew","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"result","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"ownerOf","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"pendingOwner","type":"address"}],"name":"ownershipHandoverExpiresAt","outputs":[{"internalType":"uint256","name":"result","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"ownershipHandoverValidFor","outputs":[{"internalType":"uint64","name":"","type":"uint64"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"requestOwnershipHandover","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"s_MAXMILADYCOLA","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"s_saleIsActive","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"safeTransferFrom","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"bytes","name":"_data","type":"bytes"}],"name":"safeTransferFrom","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"operator","type":"address"},{"internalType":"bool","name":"approved","type":"bool"}],"name":"setApprovalForAll","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"baseURI","type":"string"}],"name":"setBaseURI","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes4","name":"interfaceId","type":"bytes4"}],"name":"supportsInterface","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"symbol","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"tokenURI","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"}],"name":"tokensOfOwner","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"uint256","name":"start","type":"uint256"},{"internalType":"uint256","name":"stop","type":"uint256"}],"name":"tokensOfOwnerIn","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"transferFrom","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"withdraw","outputs":[],"stateMutability":"nonpayable","type":"function"}]
                
                //const contractPromise = new Promise(function (resolve, reject) 
                const contract = new web3.eth.Contract(contractABI, contractAddress);
                

                async function getProp() {
                    saleOn=await contract.methods.s_saleIsActive().call();
                    totalSup = await contract.methods.totalSupply().call();
                    console.log(totalSup,"tokens")
                }
                getProp();

                function errorTell(message) {
                    alert(`Something went wrong, here is what the chain said when we checked: ${message} go dm miladystation for help`);
                }
                // Connect to the MetaMask wallet
                connectWallet = async() => {
                    let connected = false;
                    try {
                        accounts = await web3.eth.requestAccounts().then()
                        connected = true;
                    } catch(err) {
                        errorTell(err.message);
                    }   
                    if(connected){
                        var connectbutt = document.getElementById('connect-button');
                        connectbutt.innerText = 'Connected';
                        connectbutt.disabled = true;
                        connectbutt.style.fontSize = "20px";

                        const networkId = await web3.eth.net.getId();
                        if (networkId !== 1) {
                        // Show an error message or take other appropriate action
                        alert('change your network to eth main')
                        }

                        checkWallet();
                    }
                }
                checkWallet = async() => {
                    console.log('whats in your wallet');
                    try {
                        friend = await contract.methods
                        .friendCheck(accounts[0]).call();
                        //this needs to be milady and friend check respectively
                    } catch(err){
                        errorTell(err.message);
                    }
                    console.log('is we friend? : ', friend)
                }

                function phaseTwoMint() {
                    if (saleOn){
                        document.getElementById("mint-button").style.display = "none";
                        document.getElementById("mnt-btn").style.display = "block";
                        document.getElementById("mint-input").style.display = "block";
                    } else {
                        alert('sale is not active, come back soon')
                    }

                }
                function phaseTwoRedeem() {
                    alert('We are not redeeming right now, I guess we shouldnt have the button up for it but it gives a nice balance dont you think?')
                }

                mint = async(amt) => {
                    document.getElementById("mint-button").style.display = "block";
                    document.getElementById("mnt-btn").style.display = "none";
                    document.getElementById("mint-input").style.display = "none";

                    amt = parseInt(document.getElementById("mint-input").value);
                    if(!accounts[0]){
                        alert('connect your wallet')
                    }
                    if(amt > 48){
                        alert('BTW This will not work, you can only buy 48 pack at a time')
                    }
                    var mintbutt = document.getElementById('mint-button');
                        mintbutt.innerText = 'Minting';
                        mintbutt.disabled = true;
                        
                    if (friend > 0) {
                        value = amt * 10000000000000000;
                        try {
                            await contract.methods
                                .mintFriend(amt)
                                .send({
                                    from: accounts[0],
                                    value: value
                                });
                        } catch (err) {
                            errorTell(err.message);
                        }
                    } else {
                        if(amt < 10) {
                            value = amt * 12500000000000000;
                            try {
                                await contract.methods
                                    .mintNew(amt)
                                    .send({
                                        from: accounts[0],
                                        value: value
                                    });
                                    alert(`oh my gosh you just minted ${amt} MiladyCola Bottles! We aren't redeeming for raffles yet but keep an eye out and hold on to them tight until then, they could be winners!!`)
                            } catch (err) {
                                errorTell(err.message);
                            }
                            mintbutt.innerText = 'Mint Bottles';
                            mintbutt.disabled = false;
                        } else {
                            value = amt * 11000000000000000;
                            try {
                                await contract.methods
                                    .mintNew(amt)
                                    .send({
                                        from: accounts[0],
                                        value: value
                                    });
                                    alert(`oh my gosh you just minted ${amt} MiladyCola Bottles! We aren't redeeming for raffles yet but keep an eye out and hold on to them tight until then, they could be winners!!`)
                            } catch (err) {
                                errorTell(err.message);
                            }
                            mintbutt.innerText = 'Mint Bottles';
                            mintbutt.disabled = false;
                        }
                        
                    }
                    
                }

            </script>
            
            <!-- mobile tapping -->
            <script>
                // Get all dropdown elements
                var dropdowns = document.querySelectorAll('.dropdown');

                // Loop through each dropdown element
                for (var i = 0; i < dropdowns.length; i++) {
                // Add a click event listener to toggle the display of the dropdown items
                dropdowns[i].addEventListener('click', function() {
                    this.classList.toggle('active');
                    var dropitems = this.querySelector('.dropitems');
                    if (dropitems.style.display === 'block') {
                    dropitems.style.display = 'none';
                    } else {
                    dropitems.style.display = 'block';
                    }
                });
                }
                    
                
            </script>



    </head>
    <body>
        <div class="help">
            <div class="options">
                <ul>
                    <li>
                        <div class="dropdown">
                        About
                            <div class="dropitems">
                                <p>MiladyCola is a raffle lottery NFT that you can burn for a chance to win 1 Milady!</p>
                                <p>The MiladyCola bottles come in multiple flavors that nod to loveable milady derivatives</p>
                                <p>When you drink/burn your bottle nft and redeem it for a cap nft, you are interacting with a second contract that utilizes chainlink vrf to determine our winners!</p>
                                <p>It only takes 1 MiladyCola and a little bit of luck to WIN</p>
                                <p>2/3 of the mint proceeds go towards sweeping MILx on NFTX for our winners, the rest goes to purchasing 5,000LINK for the vrf work as well as compensating the artist and developer</p>
                                <p>The odds of winning will depend on how much MILx we can acquire with the mint proceeds. Once 2/3 of the mint has gone, the odds will be calculated</p>
                                <p>Winners will have 1.02 MILx automatically deposited into their wallet for a random redeem from the NFTX vault!</p>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="dropdown">
                        Contracts
                            <div class="dropitems">
                                <p>MiladyCola Bottle NFT Contract <a href="https://etherscan.io/address/0xe0c839d60f15dd0b939e93d9eeab5ecda9affe57#code">view on etherscan</a></p>
                                <p>MiladyCola Cap NFT Contract <a>under development (dm miladystation)</a></p>
                                <p>MiladyCola Raffle NFT Contract <a>under development</a></p>
                                <p>Admin Wallet <a href="https://etherscan.io/address/0xFfDAe607cd28f6Db1303eC333Aa37A13E01f78Dd">view on etherscan</a></p>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="dropdown">
                            Etherscan Tutorial
                                <div class="dropitems">
                                    <p>We get it, this isn't scatter art. If you want to mint from the contract here is what you do:</p>
                                    <p>First head to etherscan on a web3 wallet enabled browser. Go to the bottle nft contract and click the contract tab then write to contract.</p>
                                    <p>Use the mintNew function and however many you want, make sure you use 12500000000000000 wei or .0125 eth a pop</p>
                                    <p>If this doesn't make sense dm miladystation on twitter</p>
                                </div>
                        </div>
                    </li>
                    <li>
                        <div class="dropdown">
                            FAQ
                            <div class="dropitems">
                                <h3>How much are they?</h3>
                                <p>.0125 a pop (.011 in batches greater than 10) or .01 for milady and friends (remilio,cigawrette,milady aura,miladystation)</p>
                                <p>omg and the first 349 friends get a freebie</p>
                                <h3>What are the odds</h3>
                                <p>The odds will be calculated after 2/3 of the bottles are minted</p>
                                <p>But hypothetically if only friends mint and if Milady stays at 1.3 floor price we can pick up ~49 Miladys</p>
                                <p>49 Miladys, 10000 tickets, HYPOTHETICALLY 1/200 odds!!!</p>
                                <h3>Who made dis?</h3>
                                <p>Bottles and caps created by Angel Eyes, contracts and website by MiladyStation</p>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
            <div class="connect">
                <button id="connect-button" onclick="connectWallet()">Connect</button>
            </div>
        </div>
        <div class="landing">
        <div class="marquee">
            <div class="marquee__content">
                <h1 id="title">miladycola</h1>
                <h1 id="title2">miladycola</h1>
                <h1 id="title3">miladycola</h1>
                <h1 id="title4">miladycola</h1>
                <h1 id="title5">miladycola</h1>
                <h1 id="title6">miladycola</h1>
                <h1 id="title7">miladycola</h1>
                <h1 id="title8">miladycola</h1>
                <h1 id="title9">miladycola</h1>
            </div>
            <div aria-hidden="true" class="marquee__content">
                <h1 id="title">miladycola</h1>
                <h1 id="title2">miladycola</h1>
                <h1 id="title3">miladycola</h1>
                <h1 id="title4">miladycola</h1>
                <h1 id="title5">miladycola</h1>
                <h1 id="title6">miladycola</h1>
                <h1 id="title7">miladycola</h1>
                <h1 id="title8">miladycola</h1>
                <h1 id="title9">miladycola</h1>
            </div>
        </div>
        
        <div class="progress-bar-container">
            <div id="progress-bar"></div>
            <div id="progress-text"></div>
          </div>
        
            <nav>
                
                <ul>
                    <li>
                        <button id="mint-button" onclick="phaseTwoMint()">MiladyCola</button>
                        <input class="mint-input" id="mint-input"/>
                        <button id="mnt-btn" onclick="mint()">Mint Bottle(s)</button>
                    </li>
                <!-- <li><button id="redeem-button" onclick="phaseTwoRedeem()" display="none">Redeem Cap</button></li> -->
                    <li>            
                        <audio controls autoplay loop>
                            <source src="public/ColaSong.wav" type="audio/wav">
                            Your browser does not support the audio element.
                        </audio>
                    </li>
                </ul>
                
 
            </nav>
        </div>
        <footer>
            <img src="public/sodapopinski.gif"/>
            <img src="public/alottery.gif">
            <img src="public/cola.gif"/>
            <img src="public/lain-dancing.gif"/>
            <img src="public/lain.gif"/>
            <img src="public/soda-cow.gif"/>
        </footer>
        
    </body>
                <!-- progress bar -->
                <script>
                        // function sleep(ms) {
                        //     return new Promise((resolve) => {
                        //     setTimeout(resolve, ms);
                        //     });
                        // }
                        // sleep(10000);

                        // // Get the total supply information from the contract
                        // const totalSupply = 10000;
                        // // Assume that you have a variable called "mintedCount" that tracks the number of tokens that have been minted so far
                        // const mintedCount = totalSup;
                        // //const mintedCount = 1000;
                        
                        // // Calculate the percentage of minting progress
                        // const progressPercentage = (mintedCount / totalSupply) * 100;
                        
                        // // Update the progress bar width and text
                        
                        // document.getElementById("progress-bar").style.width = progressPercentage + "%";
                        // document.getElementById("progress-text").innerHTML = progressPercentage.toFixed(2) + "% Minted";
                        // console.log('were making a progress bar')
                </script>
</html>