<!DOCTYPE html>

<html>
    <head>
        <title>MiladyCola</title>
        <link rel="shortcut icon" href="public/cola.gif" width=32px>
        <link 
            rel="stylesheet"
            href="style.css"
            >
            <script src="https://unpkg.com/web3@1.8.2/dist/web3.min.js"></script>

            <!-- bottle nft contract -->
            <script>

                const web3 = new Web3(Web3.givenProvider); 
                //console.log(web3)
                var accounts = [];
                var friend;
                var approve;
                var thirster;
                var totalSup;
                var targets = [];
                var test =true;
                var saleOn = true;

                                    // Test
                const bottleAddress = "0xFac6478a6e9Cece4931b25a7d938c013F4568779";
                const icolaAddress = "0x8a8a1b7Fd9204d307982d610c92B2227961d3d33";
                const capAddress = "0x685B18abDC4053F4680D60E4f0A351e366cA8c3B";

                // The ABI of the smart contract
                const bottleContractABI = 
                [{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"name":"ApprovalCallerNotOwnerNorApproved","type":"error"},{"inputs":[],"name":"ApprovalQueryForNonexistentToken","type":"error"},{"inputs":[],"name":"BalanceQueryForZeroAddress","type":"error"},{"inputs":[],"name":"InvalidQueryRange","type":"error"},{"inputs":[],"name":"MintERC2309QuantityExceedsLimit","type":"error"},{"inputs":[],"name":"MintToZeroAddress","type":"error"},{"inputs":[],"name":"MintZeroQuantity","type":"error"},{"inputs":[],"name":"NewOwnerIsZeroAddress","type":"error"},{"inputs":[],"name":"NoHandoverRequest","type":"error"},{"inputs":[],"name":"OwnerQueryForNonexistentToken","type":"error"},{"inputs":[],"name":"OwnershipNotInitializedForExtraData","type":"error"},{"inputs":[],"name":"TransferCallerNotOwnerNorApproved","type":"error"},{"inputs":[],"name":"TransferFromIncorrectOwner","type":"error"},{"inputs":[],"name":"TransferToNonERC721ReceiverImplementer","type":"error"},{"inputs":[],"name":"TransferToZeroAddress","type":"error"},{"inputs":[],"name":"URIQueryForNonexistentToken","type":"error"},{"inputs":[],"name":"Unauthorized","type":"error"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"approved","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"operator","type":"address"},{"indexed":false,"internalType":"bool","name":"approved","type":"bool"}],"name":"ApprovalForAll","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"fromTokenId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"toTokenId","type":"uint256"},{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"}],"name":"ConsecutiveTransfer","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"pendingOwner","type":"address"}],"name":"OwnershipHandoverCanceled","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"pendingOwner","type":"address"}],"name":"OwnershipHandoverRequested","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"oldOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"Transfer","type":"event"},{"inputs":[],"name":"IPFSURI","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"MILADYCOLA_PROVENANCE","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"approve","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"bottlePrice","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"burn","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"cancelOwnershipHandover","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"uint256","name":"bottle","type":"uint256"},{"internalType":"uint256","name":"friend","type":"uint256"}],"name":"changePrice","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"pendingOwner","type":"address"}],"name":"completeOwnershipHandover","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"explicitOwnershipOf","outputs":[{"components":[{"internalType":"address","name":"addr","type":"address"},{"internalType":"uint64","name":"startTimestamp","type":"uint64"},{"internalType":"bool","name":"burned","type":"bool"},{"internalType":"uint24","name":"extraData","type":"uint24"}],"internalType":"struct IERC721A.TokenOwnership","name":"","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256[]","name":"tokenIds","type":"uint256[]"}],"name":"explicitOwnershipsOf","outputs":[{"components":[{"internalType":"address","name":"addr","type":"address"},{"internalType":"uint64","name":"startTimestamp","type":"uint64"},{"internalType":"bool","name":"burned","type":"bool"},{"internalType":"uint24","name":"extraData","type":"uint24"}],"internalType":"struct IERC721A.TokenOwnership[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"flipSaleState","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"friendPrice","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"getApproved","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"operator","type":"address"}],"name":"isApprovedForAll","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"holder","type":"address"}],"name":"miladyHolderCheck","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"numberOfTokens","type":"uint256"}],"name":"mintFriend","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"uint256","name":"numberOfTokens","type":"uint256"}],"name":"mintNew","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"holder","type":"address"}],"name":"monyCheck","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"result","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"ownerOf","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"pendingOwner","type":"address"}],"name":"ownershipHandoverExpiresAt","outputs":[{"internalType":"uint256","name":"result","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"ownershipHandoverValidFor","outputs":[{"internalType":"uint64","name":"","type":"uint64"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"requestOwnershipHandover","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"s_MAXMILADYCOLA","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"s_saleIsActive","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"safeTransferFrom","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"bytes","name":"_data","type":"bytes"}],"name":"safeTransferFrom","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"operator","type":"address"},{"internalType":"bool","name":"approved","type":"bool"}],"name":"setApprovalForAll","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"baseURI","type":"string"}],"name":"setBaseURI","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"provenanceHash","type":"string"}],"name":"setProvenanceHash","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes4","name":"interfaceId","type":"bytes4"}],"name":"supportsInterface","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"symbol","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"tokenURI","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"}],"name":"tokensOfOwner","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"uint256","name":"start","type":"uint256"},{"internalType":"uint256","name":"stop","type":"uint256"}],"name":"tokensOfOwnerIn","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"transferFrom","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"withdraw","outputs":[],"stateMutability":"nonpayable","type":"function"}]
                const icolaContractABI = 
                [{"inputs":[{"internalType":"uint64","name":"subscriptionId","type":"uint64"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[{"internalType":"address","name":"have","type":"address"},{"internalType":"address","name":"want","type":"address"}],"name":"OnlyCoordinatorCanFulfill","type":"error"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"}],"name":"OwnershipTransferRequested","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"playa","type":"address"},{"indexed":false,"internalType":"uint256","name":"requestId","type":"uint256"},{"indexed":false,"internalType":"uint256[]","name":"randomWords","type":"uint256[]"}],"name":"RequestFulfilled","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"requestId","type":"uint256"},{"indexed":false,"internalType":"uint32","name":"numWords","type":"uint32"}],"name":"RequestSent","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"requestId","type":"uint256"},{"indexed":false,"internalType":"address","name":"playa","type":"address"}],"name":"winner","type":"event"},{"inputs":[],"name":"_bottleAddress","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"_capAddress","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"_miladyXAddress","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"acceptOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256[]","name":"bottleTokenNums","type":"uint256[]"}],"name":"bottlePop","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"checkMIL","outputs":[{"internalType":"uint256","name":"mil","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_requestId","type":"uint256"}],"name":"getRequestStatus","outputs":[{"internalType":"bool","name":"fulfilled","type":"bool"},{"internalType":"uint256[]","name":"randomWords","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"lastRequestId","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"odds","outputs":[{"internalType":"uint32","name":"","type":"uint32"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"requestId","type":"uint256"},{"internalType":"uint256[]","name":"randomWords","type":"uint256[]"}],"name":"rawFulfillRandomWords","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"requestIds","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"s_requests","outputs":[{"internalType":"bool","name":"fulfilled","type":"bool"},{"internalType":"bool","name":"exists","type":"bool"},{"internalType":"address","name":"playa","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint32","name":"newGas","type":"uint32"}],"name":"setGasLimit","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint32","name":"newOdds","type":"uint32"}],"name":"setOdds","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"withdrawMIL","outputs":[],"stateMutability":"nonpayable","type":"function"}]
                const capContractABI = 
                [{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"name":"ApprovalCallerNotOwnerNorApproved","type":"error"},{"inputs":[],"name":"ApprovalQueryForNonexistentToken","type":"error"},{"inputs":[],"name":"BalanceQueryForZeroAddress","type":"error"},{"inputs":[],"name":"InvalidQueryRange","type":"error"},{"inputs":[],"name":"MintERC2309QuantityExceedsLimit","type":"error"},{"inputs":[],"name":"MintToZeroAddress","type":"error"},{"inputs":[],"name":"MintZeroQuantity","type":"error"},{"inputs":[],"name":"NewOwnerIsZeroAddress","type":"error"},{"inputs":[],"name":"NoHandoverRequest","type":"error"},{"inputs":[],"name":"OwnerQueryForNonexistentToken","type":"error"},{"inputs":[],"name":"OwnershipNotInitializedForExtraData","type":"error"},{"inputs":[],"name":"TransferCallerNotOwnerNorApproved","type":"error"},{"inputs":[],"name":"TransferFromIncorrectOwner","type":"error"},{"inputs":[],"name":"TransferToNonERC721ReceiverImplementer","type":"error"},{"inputs":[],"name":"TransferToZeroAddress","type":"error"},{"inputs":[],"name":"URIQueryForNonexistentToken","type":"error"},{"inputs":[],"name":"Unauthorized","type":"error"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"approved","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"operator","type":"address"},{"indexed":false,"internalType":"bool","name":"approved","type":"bool"}],"name":"ApprovalForAll","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"fromTokenId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"toTokenId","type":"uint256"},{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"}],"name":"ConsecutiveTransfer","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"pendingOwner","type":"address"}],"name":"OwnershipHandoverCanceled","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"pendingOwner","type":"address"}],"name":"OwnershipHandoverRequested","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"oldOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"Transfer","type":"event"},{"inputs":[],"name":"IPFSURI","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"admin","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"approve","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"cancelOwnershipHandover","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"pendingOwner","type":"address"}],"name":"completeOwnershipHandover","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"explicitOwnershipOf","outputs":[{"components":[{"internalType":"address","name":"addr","type":"address"},{"internalType":"uint64","name":"startTimestamp","type":"uint64"},{"internalType":"bool","name":"burned","type":"bool"},{"internalType":"uint24","name":"extraData","type":"uint24"}],"internalType":"struct IERC721A.TokenOwnership","name":"","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256[]","name":"tokenIds","type":"uint256[]"}],"name":"explicitOwnershipsOf","outputs":[{"components":[{"internalType":"address","name":"addr","type":"address"},{"internalType":"uint64","name":"startTimestamp","type":"uint64"},{"internalType":"bool","name":"burned","type":"bool"},{"internalType":"uint24","name":"extraData","type":"uint24"}],"internalType":"struct IERC721A.TokenOwnership[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"getApproved","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"operator","type":"address"}],"name":"isApprovedForAll","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"numberOfTokens","type":"uint256"},{"internalType":"address","name":"player","type":"address"}],"name":"mintCap","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"result","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"ownerOf","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"pendingOwner","type":"address"}],"name":"ownershipHandoverExpiresAt","outputs":[{"internalType":"uint256","name":"result","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"ownershipHandoverValidFor","outputs":[{"internalType":"uint64","name":"","type":"uint64"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"requestOwnershipHandover","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"s_MAXCAPS","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"safeTransferFrom","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"bytes","name":"_data","type":"bytes"}],"name":"safeTransferFrom","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"newAdmin","type":"address"}],"name":"setAdmin","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"operator","type":"address"},{"internalType":"bool","name":"approved","type":"bool"}],"name":"setApprovalForAll","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"baseURI","type":"string"}],"name":"setBaseURI","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes4","name":"interfaceId","type":"bytes4"}],"name":"supportsInterface","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"symbol","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"tokenURI","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"}],"name":"tokensOfOwner","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"uint256","name":"start","type":"uint256"},{"internalType":"uint256","name":"stop","type":"uint256"}],"name":"tokensOfOwnerIn","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"transferFrom","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"withdraw","outputs":[],"stateMutability":"nonpayable","type":"function"}]
                
                const bottle = new web3.eth.Contract(bottleContractABI, bottleAddress);
                const icola = new web3.eth.Contract(icolaContractABI, icolaAddress);
                const cap = new web3.eth.Contract(capContractABI, capAddress);

                async function getProp() {
                    
                    saleOn=await bottle.methods.s_saleIsActive().call();
                    totalSup = await bottle.methods.totalSupply().call();
                    totalBurn = await cap.methods.totalSupply().call();
                    odds = await icola.methods.odds().call();
                    mil = await icola.methods.checkMIL().call();

                    console.log(totalSup,"tokens")
                    console.log(odds)
                    document.getElementById("odds").innerHTML=`Odds are: 1/${odds}`
                    document.getElementById("bottlesBurned").innerHTML=`Bottles burned: ${totalBurn}`
                }
                getProp();

                //cosmetics
                function errorTell(message) {
                    alert(`Something went wrong, here is what the chain said when we checked: ${message}`);
                }
                function hide(id) {
                    let el = document.getElementById(id);
                    el.style.display = "none";
                }
                function show(id) {
                    let el = document.getElementById(id);
                    el.style.display = "block";
                }
                function popUp(f,tokens,tx){
                    console.log('there should be popup rn')
                    console.log(document.getElementById('txinfo').style)
                    document.getElementById('txinfo').style.display = 'grid';
                    let title = document.getElementById('txtitle')
                    let txt = document.getElementById('txtext')
                    if(f=='mint'){
                        title.innerHTML = 'Bottles minted'
                        txt.innerHTML = `oh my gosh you just minted ${tokens} MiladyCola Bottles! Here's your tx ${tx}`
                    } else if(f=='pop'){
                        title.innerHTML = 'Bottles popped'
                        txt.innerHTML = `whoa you just popped off bottle ${tokens} lfg. If you won, the milady token will be sent to your wallet shortly. Otherwise, you can double check the vrf request by going to the icola contract. here's the transaction ${tx}`
                    }
                }
                function closePop() {
                    document.getelementById('txinfo').style.display = none;
                }
                
                // Connect to the MetaMask wallet
                connectWallet = async() => {
                    console.log('you clicked connect')
                    let connected = false;
                    try {
                        accounts = await web3.eth.requestAccounts().then()
                        connected = true;
                    } catch(err) {
                        errorTell(err.message);
                    }   
                    if(connected){
                        var connectbutt = document.getElementById('connect-button');
                        connectbutt.innerText = 'Connected';
                        connectbutt.disabled = true;
                        connectbutt.style.fontSize = "20px";

                        const networkId = await web3.eth.net.getId();
                        // console.log(networkId);
                        if (networkId !== 11155111) {
                        // Show an error message or take other appropriate action
                        alert('change your network to sepolia')
                        }

                        checkWallet();
                    }
                }
                // See if qualify for discount AND if approveAll icola
                checkWallet = async() => {
                    console.log('whats in your wallet');
                    test = false;
                    try {
                        friend = await bottle.methods
                        .tokensOfOwner(accounts[0]).call();
                    } catch(err){
                        console.log(err);
                        errorTell(err.message);
                    }
                    //console.log('is we friend? : ', friend.length)
                    try {
                        approve = await bottle.methods
                        .isApprovedForAll(accounts[0],icolaAddress)
                        .call();
                    } catch(err){
                        console.log(err);
                        errorTell(err.message)
                    }
                    console.log('is we approved',approve)
                }
                
                //primer
                function phaseTwoMint() {
                    if (saleOn || test){
                        hide("mint-button");
                        show("mnt-btn");
                        show("mint-input");
                    } else {
                        alert('sale is not active, come back soon')
                    }

                }
                phaseTwoRedeem = async () => {
                    var playerBottles
                    if(!accounts[0]){
                        alert('connect your wallet')
                        return
                    }
                    if (!approve) {
                        hide("redeem-button")
                        show("approve-button")
                        return
                    }
                   
                   hide("redeem-button");
                   show("pop");
                   
                   if (test) {
                   playerBottles = [304,305,306,307,308,309,310,311,312,313,314,315];
                   } else {
                    playerBottles = await bottle.methods.tokensOfOwner(accounts[0]).call();
                   }
                   
                   var bottleList = document.getElementById("bottleList");
                   let i = 0;
                   for (bot in playerBottles) {
                    if (i < 10) {
                        let li = document.createElement("li");
                        li.appendChild(document.createTextNode(playerBottles[bot]));
                        li.setAttribute("class","bottle");
                        li.setAttribute("onclick",`listEff(${playerBottles[bot]})`);
                        li.setAttribute("id",`bottle-${playerBottles[bot]}`)
                        bottleList.appendChild(li);
                    i++
                    } else if (i == 10 ){
                        let li = document.createElement("li");
                        li.appendChild(document.createTextNode("..."));
                        li.setAttribute("class","bottle");
                        bottleList.appendChild(li);
                    i++
                    }
                   }
                   i=0;
                   show("bottleList");
                }
                function listEff(token) {
                    targets.push(token);
                    let bott = document.getElementById(`bottle-${token}`)
                    // bott.setAttribute("class","clicked");
                    // bott.removeAttribute("class","bottle");
                    bott.removeAttribute("onclick",`listEff(${token})`)
                    bott.style.fontFamily="rubikburned";
                }
                setApprove = async() => {
                    console.log('yea approve that shit');
                    if(test){
                            approve = true;
                    } else {
                        try {
                        await bottle.methods
                        .setApprovalForAll(
                            icolaAddress,
                            true
                        )
                        .send({
                                from: accounts[0]
                            });
                    } catch (err) {
                        errorTell(err.message);
                    }
                    }
                    hide("approve-button");
                    show("redeem-button");
                }
                
                //contract interaction
                //mint bottles
                mint = async(amt) => {
                    console.log('we mintin');
                    document.getElementById("mint-button").style.display = "block";
                    document.getElementById("mnt-btn").style.display = "none";
                    document.getElementById("mint-input").style.display = "none";

                    amt = parseInt(document.getElementById("mint-input").value);
                    console.log(amt);
                    if(!accounts[0]){
                        alert('connect your wallet')
                    }
                    if(amt > 48){
                        alert('BTW This will not work, you can only buy 24 pack at a time')
                    }
                    var mintbutt = document.getElementById('mint-button');
                        mintbutt.innerText = 'Minting';
                        mintbutt.disabled = true;
                        
                    // if (friend > 0) {
                    //     value = amt * 10000000000000000;
                    //     try {
                    //         await contract.methods
                    //             .mintFriend(amt)
                    //             .send({
                    //                 from: accounts[0],
                    //                 value: value
                    //             });
                    //     } catch (err) {
                    //         errorTell(err.message);
                    //     }
                    // } else {
                        // if (amt < 11) {
                            value = amt * 12500000000000000;
                            try {
                                await bottle.methods
                                    .mintNew(amt)
                                    .send({
                                        from: accounts[0],
                                        value: value
                                    })
                                    .on('transactionHash', function(hash){
                                        popUp('mint',amt,hash)
                                    });
                                    
                            } catch (err) {
                                errorTell(err.message);
                            }
                            mintbutt.innerText = 'Mint Bottles';
                            mintbutt.disabled = false;
                        // } else {
                        //     value = amt * 11000000000000000;
                        //     try {
                        //         await bottle.methods
                        //             .mintNew(amt)
                        //             .send({
                        //                 from: accounts[0],
                        //                 value: value
                        //             });
                        //             alert(`oh my gosh you just minted ${amt} MiladyCola Bottles!`)
                        //     } catch (err) {
                        //         errorTell(err.message);
                        //     }
                            // mintbutt.innerText = 'Mint Bottles';
                            // mintbutt.disabled = false;
                        
                        
                    
                    
                }
                //pop bottles
                pop = async() => {
                    show("redeem-button");
                    hide("pop");
                    hide("bottleList");
                    document.getElementById("redeem-button").disabled = true;
                    //var list = `${targets}`;
                    console.log(targets);
                    console.dir(targets);
                    try {
                        await icola.methods
                        .bottlePop(targets)
                        .send({
                            from: accounts[0],
                            value: 0
                        })
                        .on('transactionHash', function(hash){
                            popUp('pop',targets,hash);
                        });
                        
                    } catch(err) {
                        console.log(err)
                        errorTell(err.message);
                    }
                    document.getElementById("redeem-button").disabled = false;
                    document.getElementById("bottleList").innerHTML = "";
                    targets = [];
                    
                }
            
            </script>
            

    </head>
    <body>
        <div class="help">
            <div class="options">
                <ul>
                    <li>
                        <div class="dropdown">
                        About
                            <div id="aboutdrop" class="dropitems">
                                <p>MiladyCola is a raffle lottery NFT that you can burn for a chance to win 1 Milady!</p>
                                <p>The MiladyCola bottles come in multiple flavors that nod to loveable milady derivatives</p>
                                <p>When you drink/burn your bottle nft and redeem it for a cap nft, you are interacting with a second contract that utilizes chainlink vrf to determine our winners!</p>
                                <p>It only takes 1 MiladyCola and a little bit of luck to WIN</p>
                                <p>2/3 of the mint proceeds go towards sweeping MILx on NFTX for our winners, the rest goes to purchasing 2,500LINK for the vrf work as well as compensating the artist and developer</p>
                                <p>The odds of winning will depend on how much MILx we can acquire with the mint proceeds. Once we get enough milady and link we will calculate odds</p>
                                <p>Winners will have 1.02 MILx automatically deposited into their wallet for a random redeem from the NFTX vault!</p>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="dropdown">
                        Contracts
                            <div id="contractdrop" class="dropitems">
                                <p>MiladyCola Bottle NFT Contract <a href="https://sepolia.etherscan.io/address/0xfac6478a6e9cece4931b25a7d938c013f4568779#code">view on etherscan</a></p>
                                <p>MiladyCola Cap NFT Contract <a href="https://sepolia.etherscan.io/address/0x685b18abdc4053f4680d60e4f0a351e366ca8c3b#code">view on etherscan</a></p>
                                <p>MiladyCola Raffle NFT Contract <a href="https://sepolia.etherscan.io/address/0x8a8a1b7fd9204d307982d610c92b2227961d3d33#code">view on etherscan</a></p>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="dropdown">
                            Tutorial
                                <div id="contractdrop" class="dropitems">
                                    <p>First you need some bottles. Connect your wallet in the top right corner and use the miladycola button to open the bottle menu to decide how many bottles to mint.</p>
                                    <p>Next you will need to approve our raffle smart contract to burn your bottles (THEY WILL BE LOST FOREVER), click the redeem cap button to get to the approval transaction and double check the transaction that it only asks for your bottles</p>
                                    <p>After you've approved your bottles, you are ready to pop em. click the redeem bottles button again and select which bottles you would like to redeem. You can only do up to 10, it is recommended to do batches as large as possible since gas is cheaper that way.</p>
                                    <p>If you win, your milady token will be in your wallet ready to random redeem from the nftx vault</p>
                                    <h3>for the haters</h3>
                                    <p>We get it, this isn't scatter art. If you want to mint from the contract here is what you do:</p>
                                    <p>First head to etherscan on a web3 wallet enabled browser. Go to the bottle nft contract and click the contract tab then write to contract.</p>
                                    <p>Use the mintNew function and however many you want, make sure you use 12500000000000000 wei or .0125 eth a pop</p>
                                    <p>If this doesn't make sense dm miladystation on twitter</p>
                                </div>
                        </div>
                    </li>
                    <li>
                        <div class="dropdown">
                            FAQ
                            <div id="faqdrop" class="dropitems">
                                <h3>How much are they?</h3>
                                <p>.0125 a pop (.011 in batches greater than 10) or .01 for milady and friends (remilio,cigawrette,milady aura,miladystation)</p>
                                <p>omg and the first 349 friends get a freebie</p>
                                <h3>Do we pay the link for the vrf?</h3>
                                <p>nope, part of the mint fund goes toward the vrf link, we got you</p>
                                <h3>How much cost</h3>
                                <p>3 Transactions: mint, approve, redeem</p>
                                <p>mint should be </p>
                                <p>approval shouldn't be too much</p>
                                <p>redeem is ~400000 gas kind of a double mint, so make sure to redeem more than 1 bottle in a batch</p>
                                <h3>What are the odds</h3>
                                <p>The odds are displayed above the contract buttons. The odds are determined by how much milady token we have and how many bottles are out there. We also need to fund the vrf chainlink</p>
                                <p>But hypothetically if only friends mint and if Milady stays at 1.3 floor price we can pick up ~49 Miladys</p>
                                <p>49 Miladys, 10000 tickets, HYPOTHETICALLY 1/200 odds!!!</p>
                                <h3>Who made dis?</h3>
                                <p>Bottles and caps created by Angel Eyes, contracts and website by MiladyStation plsnobullywaaaa</p>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="dropdown close">
                            x
                        </div>
                    </li>
                </ul>
            </div>
            <div class="connect">
                <button id="connect-button" onclick="connectWallet()">Connect</button>
            </div>
        </div>
        <div class="landing">
        <div class="marquee">
            <div class="marquee__content">
                <h1 id="title">miladycolatest</h1>
                <h1 id="title2">miladycolatest</h1>
                <h1 id="title3">miladycolatest</h1>
                <h1 id="title4">miladycolatest</h1>
                <h1 id="title5">miladycolatest</h1>
                <h1 id="title6">miladycolatest</h1>
                <h1 id="title7">miladycolatest</h1>
                <h1 id="title8">miladycolatest</h1>
                <h1 id="title9">miladycolatest</h1>
            </div>
            <div aria-hidden="true" class="marquee__content">
                <h1 id="title">miladycolatest</h1>
                <h1 id="title2">miladycolatest</h1>
                <h1 id="title3">miladycolatest</h1>
                <h1 id="title4">miladycolatest</h1>
                <h1 id="title5">miladycolatest</h1>
                <h1 id="title6">miladycola</h1>
                <h1 id="title7">miladycola</h1>
                <h1 id="title8">miladycolatest</h1>
                <h1 id="title9">miladycolatest</h1>
            </div>
        </div>
        
        <div class="progress-bar-container">
            <div id="progress-bar"></div>
            <div id="progress-text"></div>
          </div>
        
            <div id="txinfo" class="popup">
                <button id="popx" onclick="closePop()">X</button>
                <div class="popupstuff">
                    <h3 id="txtitle">tx title</h3>
                    <p id="txtext">tx info blablablablablablablabalbla</p>
                    <img src="public/sodapopinski.gif"/>
                </div>
            </div>
            <nav>
                
                <ul>
                    <li>
                        <button id="mint-button" onclick="phaseTwoMint()">MiladyCola</button>
                        <input class="mint-input" id="mint-input"/>
                        <button id="mnt-btn" onclick="mint()">Mint Bottle(s)</button>
                    </li>
                    <li>
                        <button id="redeem-button" onclick="phaseTwoRedeem()">Redeem Cap</button>
                        <button id="approve-button" onclick="setApprove()">Approve Bottles</button>
                        <div id="bottleList">
                            <ul>
                            </ul>
                        </div>
                        <button id="pop" onclick="pop()">Pop Bottles</button>
                    </li>
                    <li>            
                        <audio controls autoplay loop>
                            <source src="public/ColaSong.wav" type="audio/wav">
                            Your browser does not support the audio element.
                        </audio>
                    </li>
                </ul>
                <div class="oddinfo">
                    <ul>
                        <li>
                            <h3 id="odds">Odds are:</h3>
                        </li>
                        <li>
                            <h3 id="bottlesBurned">Bottles burned:</h3>
                        </li>
                    </ul>
                </div>
                
 
            </nav>
        </div>
        <footer>
            <img src="public/sodapopinski.gif"/>
            <img src="public/alottery.gif">
            <img src="public/cola.gif"/>
            <img src="public/lain-dancing.gif"/>
            <img src="public/lain.gif"/>
            <img src="public/soda-cow.gif"/>
        </footer>
        
    </body>
                <!-- progress bar -->
                <script>
                        // function sleep(ms) {
                        //     return new Promise((resolve) => {
                        //     setTimeout(resolve, ms);
                        //     });
                        // }
                        // sleep(10000);

                        // // Get the total supply information from the contract
                        // const totalSupply = 10000;
                        // // Assume that you have a variable called "mintedCount" that tracks the number of tokens that have been minted so far
                        // const mintedCount = totalSup;
                        // //const mintedCount = 1000;
                        
                        // // Calculate the percentage of minting progress
                        // const progressPercentage = (mintedCount / totalSupply) * 100;
                        
                        // // Update the progress bar width and text
                        
                        // document.getElementById("progress-bar").style.width = progressPercentage + "%";
                        // document.getElementById("progress-text").innerHTML = progressPercentage.toFixed(2) + "% Minted";
                        // console.log('were making a progress bar')
                </script>

                            <!-- mobile tapping -->
            <script>
                // Get all dropdown elements
                var dropdowns = document.querySelectorAll('.dropdown');
                // Loop through each dropdown element
                for (var i = 0; i < dropdowns.length; i++) {
                // Add a click event listener to toggle the display of the dropdown items
                dropdowns[i].addEventListener('click', function() {
                    
                    let opens = document.querySelectorAll('.dropitemsee');
                    
                    for (let i = 0; i < opens.length; i++){
                        // console.log(opens[i])
                        opens[i].removeAttribute("class","dropitemsee");
                        opens[i].setAttribute("class","dropitems")
                    }

                    let item = this.children[0];
                    // console.dir(item.attributes[1].nodeValue)

                    item.removeAttribute("class","dropitems");
                    item.setAttribute("class","dropitemsee");
                    

                });
                }


                function dropdownDrop(id) {
                    el = document.getElementById(id);
                    el.removeAttribute("class","dropitems");
                    el.setAttribute("class","dropitemsee");
                }
                function dropdownCatch(id) {
                    el = document.getElementById(id);
                    el.removeAttribute("class","dropitemsee");
                    el.setAttribute("class","dropitems");
                }
            </script>
</html>